<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="lt-ie10 lt-ie9 lt-ie8 lt-ie7 no-js"> <![endif]-->
<!--[if IE 7]>         <html class="lt-ie10 lt-ie9 lt-ie8 no-js"> <![endif]-->
<!--[if IE 8]>         <html class="lt-ie10 lt-ie9 no-js"> <![endif]-->
<!--[if IE 9]>         <html class="lt-ie10 no-js"> <![endif]-->
<!--[if gt IE 9]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
        <title>Flora Colossus to English Translator</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1, minimal-ui" />
        <link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>
        <link href='CSS/style.css' rel='stylesheet' type='text/css'>
        <script>
            (function () {
                var $html = document.getElementsByTagName('html')[0],
                    js = document.createElement('script'),
                    $head = $html.getElementsByTagName('head')[0];

                if ($html.className.split('lt-IE9').length > 1) {
                    js.src = 'js/jquery-1.11.1.min.js';
                } else {
                    js.src = 'js/jquery-2.1.1.min.js';
                }
                $head.appendChild(js);
                js = document.createElement('script');
                js.src = 'js/knockout-3.1.0.js';
                $head.appendChild(js);
            })();
        </script>
    </head>
    <body>
        <noscript>
            I hate sites that don't work without JavaScript. But I hate paying for hosting more. So I have a JS requirement.
        </noscript>
        <div class="">
            <textarea data-bind="value:english, disable: startMode()==='F', attr:{'placeholder': englishPlaceholder}"></textarea>
            <div class="toggle-wrap" data-bind="css: {'-reverse': startMode()==='F'}">
                <a data-bind="click: function () {
                    startMode('E')
                }">English to Flora Colossus</a>
                <a data-bind="click: function () {
                    startMode('F')
                }">Flora Colossus to English</a>
            </div>
            <textarea data-bind="value:floraColossus, disable: startMode()==='E', attr:{'placeholder': floraPlaceholder}"></textarea>
            <a class="btn" data-bind="click:translate">Translate</a>
        </div>
        <script>
            (function () {
                var $translator = {};
                function waitForLoad() {
                    if (window.jQuery === undefined || window.ko === undefined) {
                        setTimeout(function () {
                            waitForLoad();
                        },100);
                        return;
                    }
                    $translator.startMode = ko.observable('E');
                    $translator.english = ko.observable('');
                    $translator.floraColossus = ko.observable('');
                    $translator.floraPlaceholder = ko.computed(function () {
                        if ($translator.startMode() === 'E') {
                            return 'Please enter English text and Press the translate button.';
                        }
                        return 'Please enter some of the Flora Colossus language and press the translate button to see the English translation.';
                    });
                    $translator.englishPlaceholder = ko.computed(function () {
                        if ($translator.startMode() === 'E') {
                            return 'Please enter Flora Colossus text and Press the translate button.';
                        }
                        return 'Please enter some of the English language and press the translate button to see the Flora Colossus translation.';
                    });
                    $translator.floraOptions = [
                        "Flower Power Activate!",
                        "I have to be careful when I sleep. Cosmo sometimes mistakes my leg for a tree trunk.",
                        "I think you may be barking up the wrong tree.",
                        "I have no idea who Jackson Pollock is, but apparently he decorated my room.",
                        "Why does no one understand what I am saying?",
                        "Whereever you go in life, never forget your roots.",
                        "Anyone need a toothpick?",
                        "What was that? I wasn't listening.",
                        "My name isn't Groot.",
                        "Sometimes I don't know why I bother saying anything at all."
                    ];
                    $translator.startMode.subscribe(function () {
                        $translator.english('');
                        $translator.floraColossus('');
                    });
                    $translator.english.subscribe(function () {
                        var $trimed = $.trim($translator.english());
                        if ($trimed !== $translator.english()) {
                            $translator.english($trimed);
                        }
                    });
                    $translator.floraColossus.subscribe(function () {
                        var $trimed = $.trim($translator.floraColossus());
                        if ($trimed !== $translator.floraColossus()) {
                            $translator.floraColossus($trimed);
                        }
                    });
                    $translator.translate = function () {
                        var $punctuation = '.', $saying = $translator.floraOptions[Math.floor(Math.random() * ($translator.floraOptions.length))];
                        console.info('hit');
                        if ($translator.startMode() === 'E') {
                            if ($translator.english().length > 0) {
                                if ($translator.floraColossus().length % 2 === 0 ) {
                                    $punctuation = '!';
                                }
                                $translator.floraColossus('I am Groot' + $punctuation);
                            }
                            return;
                        }
                        if (
                            $translator.floraColossus().toLowerCase() === 'i am groot' ||
                            $translator.floraColossus().toLowerCase() === 'i am groot.'||
                            $translator.floraColossus().toLowerCase() === 'i am groot!'||
                            $translator.floraColossus().toLowerCase() === 'i am groot?'
                        ) {
                            $translator.english($saying);
                        } else {
                            $translator.english('Error... Phrase not recognized as part of the Flora Colossus language');
                        }
                    }
                    ko.applyBindings($translator);
                }
                waitForLoad();
            })();
        </script>
    </body>
</html>
