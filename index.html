<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="lt-ie10 lt-ie9 lt-ie8 lt-ie7 no-js"> <![endif]-->
<!--[if IE 7]>         <html class="lt-ie10 lt-ie9 lt-ie8 no-js"> <![endif]-->
<!--[if IE 8]>         <html class="lt-ie10 lt-ie9 no-js"> <![endif]-->
<!--[if IE 9]>         <html class="lt-ie10 no-js"> <![endif]-->
<!--[if gt IE 9]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
        <title>Flora Colossus to English Translator</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1, minimal-ui" />
        <link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,400,300,600' rel='stylesheet' type='text/css'>
        <link href='CSS/style.css' rel='stylesheet' type='text/css'>
        <!-- Project Wonderful Ad Box Loader -->
        <script type="text/javascript">
           (function(){function pw_load(){
              if(arguments.callee.z)return;else arguments.callee.z=true;
              var d=document;var s=d.createElement('script');
              var x=d.getElementsByTagName('script')[0];
              s.type='text/javascript';s.async=true;
              s.src='//www.projectwonderful.com/pwa.js';
              x.parentNode.insertBefore(s,x);}
           if (window.attachEvent){
            window.attachEvent('DOMContentLoaded',pw_load);
            window.attachEvent('onload',pw_load);}
           else{
            window.addEventListener('DOMContentLoaded',pw_load,false);
            window.addEventListener('load',pw_load,false);}})();
        </script>
        <!-- End Project Wonderful Ad Box Loader -->
        <script>
            (function () {
                var $html = document.getElementsByTagName('html')[0],
                    js = document.createElement('script'),
                    $head = $html.getElementsByTagName('head')[0];

                if ($html.className.split('lt-IE9').length > 1) {
                    js.src = 'js/jquery-1.11.1.min.js';
                } else {
                    js.src = 'js/jquery-2.1.1.min.js';
                }
                $head.appendChild(js);
                js = document.createElement('script');
                js.src = 'js/knockout-3.1.0.js';
                $head.appendChild(js);
            })();
        </script>
    </head>
    <body>
        <noscript>
            I hate sites that don't work without JavaScript. But I hate paying for hosting more. So I have a JS requirement.
        </noscript>

        <div class="wrap">
            <h1>English to Flora Colossus Translator</h1>
            <p>
                The time may come when traveling around the galaxy when you run into a Flora Colossus. Not to be mistaken as an Ent of Middle Earth,
                Flora Colossus are tree-like beings from Planet X, the capital of the branch worlds. Unfortunately for us, their biology makes it difficult
                for us to always understand what they are saying. Most being simply hear the phrase: <em>I am Groot</em>.
            </p>
            <p>
                Thanks to cutting edge research in the field of Xenolinguistics, we have been able to understand what they are saying to you and in return
                translate your phrase into a phrase that is more in line with their natural toungue.
            </p>
            <textarea class="english" data-bind="value:english, disable: startMode()==='F', attr:{'placeholder': englishPlaceholder}"></textarea>
            <div class="toggle-wrap" data-bind="css: {'-reverse': startMode()==='F'}">
                <a data-bind="click: function () {
                    startMode('E')
                }">English to Flora Colossus</a>
                <a data-bind="click: function () {
                    startMode('F')
                }">Flora Colossus to English</a>
            </div>
            <textarea class="flora" data-bind="value:floraColossus, disable: startMode()==='E', attr:{'placeholder': floraPlaceholder}"></textarea>
            <a class="btn" data-bind="click:translate">Translate</a>
            <div class="ad-wrap">
                <div class="advertisement">
                    <!-- Project Wonderful Ad Box Code -->
                    <div id="pw_adbox_74063_5_0"></div>
                    <script type="text/javascript"></script>
                    <noscript><map name="admap74063" id="admap74063"><area href="http://www.projectwonderful.com/out_nojs.php?r=0&c=0&id=74063&type=5" shape="rect" coords="0,0,728,90" title="" alt="" target="_blank" /></map>
                    <table cellpadding="0" cellspacing="0" style="width:728px;border-style:none;background-color:#ffffff;">
                    <tr><td><img src="http://www.projectwonderful.com/nojs.php?id=74063&type=5" style="width:728px;height:90px;border-style:none;" usemap="#admap74063" alt="" /></td></tr><tr><td style="background-color:#ffffff;" colspan="1"><center><a style="font-size:10px;color:#0000ff;text-decoration:none;line-height:1.2;font-weight:bold;font-family:Tahoma, verdana,arial,helvetica,sans-serif;text-transform: none;letter-spacing:normal;text-shadow:none;white-space:normal;word-spacing:normal;" href="http://www.projectwonderful.com/advertisehere.php?id=74063&type=5" target="_blank">Ads by Project Wonderful!  Your ad here, right now: $0</a></center></td></tr></table>
                    </noscript>
                    <!-- End Project Wonderful Ad Box Code -->
                </div>
            </div>
        </div>
        <script>
            (function () {
                var $translator = {};
                function waitForLoad() {
                    if (window.jQuery === undefined || window.ko === undefined) {
                        setTimeout(function () {
                            waitForLoad();
                        },100);
                        return;
                    }
                    function randomResult($array) {
                        return $array[Math.floor(Math.random() * ($array.length))];
                    }
                    $.get( "json/groot.json", function( groot ) {
                        $translator.startMode = ko.observable('E');
                        $translator.english = ko.observable('');
                        $translator.floraColossus = ko.observable('');
                        $translator.floraPlaceholder = ko.computed(function () {
                            if ($translator.startMode() === 'E') {
                                return 'Please enter English text and Press the translate button.';
                            }
                            return 'Please enter some of the Flora Colossus language and press the translate button to see the English translation.';
                        });
                        $translator.englishPlaceholder = ko.computed(function () {
                            if ($translator.startMode() === 'F') {
                                return 'Please enter Flora Colossus text and Press the translate button.';
                            }
                            return 'Please enter some of the English language and press the translate button to see the Flora Colossus translation.';
                        });
                        $translator.startMode.subscribe(function () {
                            $translator.english('');
                            $translator.floraColossus('');
                            setTimeout(function () {
                                if ($translator.startMode() === 'E') {
                                    $('textarea.english').focus();
                                } else {
                                    $('textarea.flora').focus();
                                }
                            }, 100);
                        });
                        $translator.english.subscribe(function () {
                            var $trimed = $.trim($translator.english());
                            if ($trimed !== $translator.english()) {
                                $translator.english($trimed);
                            }
                        });
                        $translator.floraColossus.subscribe(function () {
                            var $trimed = $.trim($translator.floraColossus());
                            if ($trimed !== $translator.floraColossus()) {
                                $translator.floraColossus($trimed);
                            }
                        });

                        $translator.translate = function () {
                            var $punctuation = '.';
                            if ($translator.startMode() === 'E') {
                                if ($translator.english().length > 0) {
                                    if ($translator.floraColossus().length % 2 === 0 ) {
                                        $punctuation = '!';
                                    }
                                    $translator.floraColossus('I am Groot' + $punctuation);
                                }
                                return;
                            }
                            switch($translator.floraColossus().toLowerCase()) {
                                case 'i am groot':
                                case 'i am groot.':
                                    $translator.english(randomResult(groot.single.statement));
                                    break;
                                case 'i am groot!':
                                    $translator.english(randomResult(groot.single.exclamation));
                                    break;
                                case 'i am groot?':
                                    $translator.english(randomResult(groot.single.question));
                                    break;
                                case 'we are groot':
                                case 'we are groot.':
                                    $translator.english(randomResult(groot.plural.statement));
                                    break;
                                case 'we are groot!':
                                    $translator.english(randomResult(groot.plural.exclamation));
                                    break;
                                case 'we are groot?':
                                    $translator.english(randomResult(groot.plural.question));
                                    break;
                                default:
                                    $translator.english('Error... Phrase not recognized as part of the Flora Colossus language');
                                    break;
                            }
                        }
                        ko.applyBindings($translator); 
                        setTimeout(function () {
                            $('textarea.english').focus();
                        });
                    });

                }
                waitForLoad();
            })();
        </script>
    </body>
</html>
